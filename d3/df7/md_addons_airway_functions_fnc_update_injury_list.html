<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KAT - Advanced Medical: fnc_updateInjuryList</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KAT - Advanced Medical
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d3/df7/md_addons_airway_functions_fnc_update_injury_list.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">fnc_updateInjuryList </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>#include "script_component.hpp" /*</p><ul>
<li>Author: mharis001</li>
<li>Updates injury list for given body part for the target.</li>
</ul>
<ul>
<li>Arguments:</li>
<li>0: Injury list &lt;CONTROL&gt;</li>
<li>1: Target &lt;OBJECT&gt;</li>
<li>2: Body part &lt;NUMBER&gt;</li>
</ul>
<ul>
<li>Return Value:</li>
<li>None</li>
</ul>
<ul>
<li>Example:</li>
<li>[_ctrlInjuries, _target, 0] call ace_medical_gui_fnc_updateInjuryList</li>
</ul>
<ul>
<li>Public: No */</li>
</ul>
<p>params ["_ctrl", "_target", "_selectionN"];</p>
<p>private _entries = [];</p>
<p>// Add selected body part name private _bodyPartName = [ <a class="el" href="../../da/df3/script__macros_8hpp_aac0d098d3f92b4b580c86685cd6d79b4.html#aac0d098d3f92b4b580c86685cd6d79b4">ACELSTRING(medical_gui,Head)</a>, <a class="el" href="../../da/df3/script__macros_8hpp_aac0d098d3f92b4b580c86685cd6d79b4.html#aac0d098d3f92b4b580c86685cd6d79b4">ACELSTRING(medical_gui,Torso)</a>, <a class="el" href="../../da/df3/script__macros_8hpp_aac0d098d3f92b4b580c86685cd6d79b4.html#aac0d098d3f92b4b580c86685cd6d79b4">ACELSTRING(medical_gui,LeftArm)</a>, <a class="el" href="../../da/df3/script__macros_8hpp_aac0d098d3f92b4b580c86685cd6d79b4.html#aac0d098d3f92b4b580c86685cd6d79b4">ACELSTRING(medical_gui,RightArm)</a>, <a class="el" href="../../da/df3/script__macros_8hpp_aac0d098d3f92b4b580c86685cd6d79b4.html#aac0d098d3f92b4b580c86685cd6d79b4">ACELSTRING(medical_gui,LeftLeg)</a>, <a class="el" href="../../da/df3/script__macros_8hpp_aac0d098d3f92b4b580c86685cd6d79b4.html#aac0d098d3f92b4b580c86685cd6d79b4">ACELSTRING(medical_gui,RightLeg)</a> ] select _selectionN;</p>
<p>_entries pushBack [localize _bodyPartName, [1, 1, 1, 1]];</p>
<p>// Indicate if unit is bleeding at all if (<a class="el" href="../../d2/d23/chemical_2script__component_8hpp_a09843105f9bf3e94105269a14e4f3c41.html#a09843105f9bf3e94105269a14e4f3c41">IS_BLEEDING(_target)</a>) then { _entries pushBack [localize <a class="el" href="../../da/df3/script__macros_8hpp_aac0d098d3f92b4b580c86685cd6d79b4.html#aac0d098d3f92b4b580c86685cd6d79b4">ACELSTRING(medical_gui,Status_Bleeding)</a>, [1, 0, 0, 1]]; };</p>
<p>if(ACEGVAR(medical_gui,showBloodLossEntry)) then { // Give a qualitative description of the blood volume lost switch (<a class="el" href="../../d2/d23/chemical_2script__component_8hpp_a527f9d9f810a46c54de7ef46bef2309f.html#a527f9d9f810a46c54de7ef46bef2309f">GET_HEMORRHAGE(_target)</a>) do { case 1: { _entries pushBack [localize <a class="el" href="../../da/df3/script__macros_8hpp_aac0d098d3f92b4b580c86685cd6d79b4.html#aac0d098d3f92b4b580c86685cd6d79b4">ACELSTRING(medical_gui,Lost_Blood1)</a>, [1, 1, 0, 1]]; }; case 2: { _entries pushBack [localize <a class="el" href="../../da/df3/script__macros_8hpp_aac0d098d3f92b4b580c86685cd6d79b4.html#aac0d098d3f92b4b580c86685cd6d79b4">ACELSTRING(medical_gui,Lost_Blood2)</a>, [1, 0.67, 0, 1]]; }; case 3: { _entries pushBack [localize <a class="el" href="../../da/df3/script__macros_8hpp_aac0d098d3f92b4b580c86685cd6d79b4.html#aac0d098d3f92b4b580c86685cd6d79b4">ACELSTRING(medical_gui,Lost_Blood3)</a>, [1, 0.33, 0, 1]]; }; case 4: { _entries pushBack [localize <a class="el" href="../../da/df3/script__macros_8hpp_aac0d098d3f92b4b580c86685cd6d79b4.html#aac0d098d3f92b4b580c86685cd6d79b4">ACELSTRING(medical_gui,Lost_Blood4)</a>, [1, 0, 0, 1]]; }; }; };</p>
<p>// Indicate if a tourniquet is applied if (<a class="el" href="../../d2/d1f/misc_2script__component_8hpp_a908292e87267caa221dd040b9e2a3944.html#a908292e87267caa221dd040b9e2a3944">HAS_TOURNIQUET_APPLIED_ON(_target,_selectionN)</a>) then { _entries pushBack [localize <a class="el" href="../../da/df3/script__macros_8hpp_aac0d098d3f92b4b580c86685cd6d79b4.html#aac0d098d3f92b4b580c86685cd6d79b4">ACELSTRING(medical_gui,Status_Tourniquet_Applied)</a>, [0.77, 0.51, 0.08, 1]]; };</p>
<p>// Indicate current body part fracture status switch (<a class="el" href="../../d2/d23/chemical_2script__component_8hpp_a5c467c4d2956336e5f2be03d36b4df46.html#a5c467c4d2956336e5f2be03d36b4df46">GET_FRACTURES(_target)</a> select _selectionN) do { case 1: { _entries pushBack [localize <a class="el" href="../../da/df3/script__macros_8hpp_aac0d098d3f92b4b580c86685cd6d79b4.html#aac0d098d3f92b4b580c86685cd6d79b4">ACELSTRING(medical_gui,Status_Fractured)</a>, [1, 0, 0, 1]]; }; case -1: { if ((<a class="el" href="../../da/df3/script__macros_8hpp_aa8d36e95205e25d880966a5df638a622.html#aa8d36e95205e25d880966a5df638a622">ACEGVAR(medical,fractures)</a>) in [2, 3]) then { _entries pushBack [localize <a class="el" href="../../da/df3/script__macros_8hpp_aac0d098d3f92b4b580c86685cd6d79b4.html#aac0d098d3f92b4b580c86685cd6d79b4">ACELSTRING(medical_gui,Status_SplintApplied)</a>, [0.2, 0.2, 1, 1]]; }; }; };</p>
<p>// Indicate the amount of pain the unit is in if (_target call <a class="el" href="../../da/df3/script__macros_8hpp_ae1638a83048f3b2eed91fd36e6cbe4a8.html#ae1638a83048f3b2eed91fd36e6cbe4a8">ACEFUNC(common,isAwake)</a>) then { private _pain = <a class="el" href="../../d2/d23/chemical_2script__component_8hpp_a88bac3d01f9ad8b451a1265439921276.html#a88bac3d01f9ad8b451a1265439921276">GET_PAIN_PERCEIVED(_target)</a>; if (_pain &gt; 0) then { private _painText = switch (true) do { case (_pain &gt; 0.5): { <a class="el" href="../../da/df3/script__macros_8hpp_aac0d098d3f92b4b580c86685cd6d79b4.html#aac0d098d3f92b4b580c86685cd6d79b4">ACELSTRING(medical_treatment,Status_SeverePain)</a>; }; case (_pain &gt; 0.1): { <a class="el" href="../../da/df3/script__macros_8hpp_aac0d098d3f92b4b580c86685cd6d79b4.html#aac0d098d3f92b4b580c86685cd6d79b4">ACELSTRING(medical_treatment,Status_Pain)</a>; }; default { <a class="el" href="../../da/df3/script__macros_8hpp_aac0d098d3f92b4b580c86685cd6d79b4.html#aac0d098d3f92b4b580c86685cd6d79b4">ACELSTRING(medical_treatment,Status_MildPain)</a>; }; }; _entries pushBack [localize _painText, [1, 1, 1, 1]]; }; };</p>
<p>// Add entries for open, bandaged, and stitched wounds private _woundEntries = [];</p>
<p>private <em>fnc_getWoundDescription = { private _classIndex = _woundClassID / 10; private _category = _woundClassID % 10; private _className = <a class="el" href="../../da/df3/script__macros_8hpp_aa8d36e95205e25d880966a5df638a622.html#aa8d36e95205e25d880966a5df638a622">ACEGVAR(medical_damage,woundClassNames)</a> select _classIndex; private _suffix = ["Minor", "Medium", "Large"] select _category; private _woundName = localize format ["STR_ACE_medical_damage&lt;/em&gt;%1_%2", _className, _suffix]; if (_amountOf &gt;= 1) then { format ["%1x %2", ceil _amountOf, _woundName]; } else { format [localize <a class="el" href="../../da/df3/script__macros_8hpp_aac0d098d3f92b4b580c86685cd6d79b4.html#aac0d098d3f92b4b580c86685cd6d79b4">ACELSTRING(medical_gui,PartialX)</a>, _woundName]; }; };</em></p>
<p><em>{ _x params ["_woundClassID", "_bodyPartN", "_amountOf"]; if (_selectionN == _bodyPartN) then { if (_amountOf &gt; 0) then { _woundEntries pushBack [call _fnc_getWoundDescription, [1, 1, 1, 1]]; } else { // ace_medical_treatment_advancedBandages // Disabled == 0 // Enabled == 1 // EnabledCanReopen == 2 if (<a class="el" href="../../da/df3/script__macros_8hpp_aa8d36e95205e25d880966a5df638a622.html#aa8d36e95205e25d880966a5df638a622">ACEGVAR(medical_treatment,advancedBandages)</a> &lt; 2) then { _woundEntries pushBack [format ["[B] %1", call _fnc_getWoundDescription], [0.7, 0.7, 0.7, 1]]; }; }; }; } forEach <a class="el" href="../../d2/d23/chemical_2script__component_8hpp_a368fc8463b34ce1eb19e5193ed39a5cf.html#a368fc8463b34ce1eb19e5193ed39a5cf">GET_OPEN_WOUNDS(_target)</a>;</em></p>
<p><em>{ _x params ["_woundClassID", "_bodyPartN", "_amountOf"]; if (_selectionN == _bodyPartN &amp;&amp; {_amountOf &gt; 0}) then { _woundEntries pushBack [format ["[B] %1", call _fnc_getWoundDescription], [0.88, 0.7, 0.65, 1]]; }; } forEach <a class="el" href="../../d2/d23/chemical_2script__component_8hpp_a8a334ed46173617919f9da744ad7032c.html#a8a334ed46173617919f9da744ad7032c">GET_BANDAGED_WOUNDS(_target)</a>;</em></p>
<p><em>{ _x params ["_woundClassID", "_bodyPartN", "_amountOf"]; if (_selectionN == _bodyPartN &amp;&amp; {_amountOf &gt; 0}) then { _woundEntries pushBack [format ["[S] %1", call _fnc_getWoundDescription], [0.7, 0.7, 0.7, 1]]; }; } forEach <a class="el" href="../../d2/d23/chemical_2script__component_8hpp_ac64da7096025d3f6667d752d36c301a2.html#ac64da7096025d3f6667d752d36c301a2">GET_STITCHED_WOUNDS(_target)</a>;</em></p>
<p><em>//INTOXICATION by DiGii private _poisontype = _target getVariable [QEGVAR(chemical,poisonType),""]; if(_target getVariable [QEGVAR(chemical,airPoisoning),false]) then{ _woundEntries pushBack [LELSTRING(chemical,Intoxication), [0.4,0,0.5,1]]; };</em></p>
<p><em>// EDIT by Katalam &amp; Tomcat if (_target getVariable [QGVAR(airway), false] &amp;&amp; _selectionN isEqualTo 0) then { private _a = _target getVariable [QGVAR(airway_item), ""]; if !(_a isEqualTo "") then { private _text = format [LSTRING(%1_Display), _a]; _woundEntries pushback [localize _text, [0.1, 1, 1, 1]]; }; };</em></p>
<p><em>if(_target getVariable [QEGVAR(breathing,pulseoximeter), false] &amp;&amp; _selectionN in [2,3]) then { if((_target getVariable [QEGVAR(breathing,PulseOximeter_Attached), [0,0]] select (_selectionN - 2)) &gt; 0) then { _entries pushback [LELSTRING(breathing,Pulseoximeter_Desc_Short), [0.3, 0.8, 0.8, 1]]; }; };</em></p>
<p><em>if (_target getVariable [QGVAR(overstretch), false] &amp;&amp; _selectionN isEqualTo 0) then { _woundEntries pushback [LLSTRING(overstretched), [0.1, 1, 1, 1]]; };</em></p>
<p><em>if (_target getVariable [QGVAR(recovery), false]) then { _entries pushback [LLSTRING(RecoveryPosition), [0.1, 1, 1, 1]]; };</em></p>
<p><em>// Display cyanosis in overview tab, only when head/arms are selected if (EGVAR(breathing,cyanosisShowInMenu) &amp;&amp; (_selectionN in [0,2,3])) then { private _spO2 = 0;</em></p>
<p><em> if (alive _target) then { _spO2 = GET_SPO2(_target); };</em></p>
<p><em> if (_spO2 &lt;= EGVAR(breathing,slightValue) || <a class="el" href="../../d2/d1f/misc_2script__component_8hpp_a908292e87267caa221dd040b9e2a3944.html#a908292e87267caa221dd040b9e2a3944">HAS_TOURNIQUET_APPLIED_ON(_target,_selectionN)</a>) then { private _cyanosisArr = switch (true) do { case (<a class="el" href="../../d2/d1f/misc_2script__component_8hpp_a908292e87267caa221dd040b9e2a3944.html#a908292e87267caa221dd040b9e2a3944">HAS_TOURNIQUET_APPLIED_ON(_target,_selectionN)</a>); case (_spO2 &lt;= EGVAR(breathing,severeValue)): { [LELSTRING(breathing,CyanosisStatus_Severe), [0.16, 0.16, 1, 1]]; }; case (_spO2 &lt;= EGVAR(breathing,mildValue)): { [LELSTRING(breathing,CyanosisStatus_Mild), [0.16, 0.315, 1, 1]]; }; default { [LELSTRING(breathing,CyanosisStatus_Slight), [0.16, 0.47, 1, 1]]; }; }; _entries pushBack [(_cyanosisArr select 0), (_cyanosisArr select 1)]; }; };</em></p>
<p><em>private _tensionhemothorax = false; if (!(EGVAR(breathing,showPneumothorax_dupe))) then { if ((_target getVariable [QEGVAR(breathing,hemopneumothorax), false]) || (_target getVariable [QEGVAR(breathing,tensionpneumothorax), false])) then { _tensionhemothorax = true; }; };</em></p>
<p><em>if (_target getVariable [QEGVAR(breathing,pneumothorax), false] &amp;&amp; _selectionN isEqualTo 1 &amp;&amp; !(EGVAR(breathing,pneumothorax_hardcore)) &amp;&amp; !(_tensionhemothorax)) then { _woundEntries pushback [LELSTRING(breathing,pneumothorax_mm), [1,1,1,1]]; };</em></p>
<p><em>if (_target getVariable [QEGVAR(breathing,hemopneumothorax), false] &amp;&amp; _selectionN isEqualTo 1 &amp;&amp; !(EGVAR(breathing,tensionhemothorax_hardcore))) then { _woundEntries pushback [LELSTRING(breathing,hemopneumothorax_mm), [1,1,1,1]]; };</em></p>
<p><em>if (_target getVariable [QEGVAR(breathing,tensionpneumothorax), false] &amp;&amp; _selectionN isEqualTo 1 &amp;&amp; !(EGVAR(breathing,tensionhemothorax_hardcore))) then { _woundEntries pushback [LELSTRING(breathing,tensionpneumothorax_mm), [1,1,1,1]]; };</em></p>
<p><em>// Show receiving IV volume remaining private _totalIvVolume = 0; private _saline = 0; private _blood = 0; private _plasma = 0;</em></p>
<p><em>{ _x params ["_volumeRemaining", "_type"]; switch (_type) do { case ("Saline"): { _saline = _saline + _volumeRemaining; }; case ("Blood"): { _blood = _blood + _volumeRemaining; }; case ("Plasma"): { _plasma = _plasma + _volumeRemaining; }; }; _totalIvVolume = _totalIvVolume + _volumeRemaining; } forEach (_target getVariable [<a class="el" href="../../da/df3/script__macros_8hpp_acd1b696f98a5c7658e5c5beb793c8abf.html#acd1b696f98a5c7658e5c5beb793c8abf">QACEGVAR(medical,ivBags)</a>, []]);</em></p>
<p><em>if (_totalIvVolume &gt;= 1) then { if (_saline &gt; 1) then { _entries pushBack ["Saline: " + (format [localize <a class="el" href="../../da/df3/script__macros_8hpp_aac0d098d3f92b4b580c86685cd6d79b4.html#aac0d098d3f92b4b580c86685cd6d79b4">ACELSTRING(medical_treatment,receivingIvVolume)</a>, floor _saline]), [1, 1, 1, 1]]; }; if (_blood &gt; 1) then { _entries pushBack ["Blood: " + (format [localize <a class="el" href="../../da/df3/script__macros_8hpp_aac0d098d3f92b4b580c86685cd6d79b4.html#aac0d098d3f92b4b580c86685cd6d79b4">ACELSTRING(medical_treatment,receivingIvVolume)</a>, floor _blood]), [1, 1, 1, 1]]; }; if (_plasma &gt; 1) then { _entries pushBack ["Plasma: " + (format [localize <a class="el" href="../../da/df3/script__macros_8hpp_aac0d098d3f92b4b580c86685cd6d79b4.html#aac0d098d3f92b4b580c86685cd6d79b4">ACELSTRING(medical_treatment,receivingIvVolume)</a>, floor _plasma]), [1, 1, 1, 1]]; }; };</em></p>
<p><em>//Handle IV placement private _placed = _target getVariable [QEGVAR(pharma,IV), [0,0,0,0,0,0]]; private _IVactual = _placed select _selectionN;</em></p>
<p><em>if (_IVactual &gt; 0) then { if (_IVactual == 1) then { _entries pushBack [LELSTRING(pharma,IO_45_Display), [0.3, 0.6, 0.3, 1]]; } else { _entries pushBack [LELSTRING(pharma,IV_16_Display), [0.3, 0.6, 0.3, 1]]; }; };</em></p>
<p><em>// Handle no wound entries if (_woundEntries isEqualTo []) then { _entries pushBack [localize <a class="el" href="../../da/df3/script__macros_8hpp_aac0d098d3f92b4b580c86685cd6d79b4.html#aac0d098d3f92b4b580c86685cd6d79b4">ACELSTRING(medical_treatment,NoInjuriesBodypart)</a>, [1, 1, 1, 1]]; } else { _entries append _woundEntries; };</em></p>
<p><em>// Add all entries to injury list lbClear _ctrl;</em></p>
<p><em>{ _x params ["_text", "_color"];</em></p>
<p><em> _ctrl lbSetColor [_ctrl lbAdd _text, _color]; } forEach _entries;</em></p>
<p><em>_ctrl lbSetCurSel -1; </em></p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
